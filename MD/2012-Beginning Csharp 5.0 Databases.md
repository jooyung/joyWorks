# Introduction
## Who This Book Is For
## How This Book Is Structured
## Conventions
## Downloading the Code
## Contacting the Author
# 1. Getting and Understanding Your Tools
- SMSS: SQL Server Management Studio
- OLTP: Online Transaction Processing

## Obtaining Visual Studio 2012
## Installing SQL Server 2012 Express
Services.msc
## Installing and Attaching the AdventureWorks Sample Database
### Installing the AdventureWorks Database
### Attaching the AdventureWorks Sample Database
**Attach** is the process used to associate the **.mdf** file to the database server so that you can start working with the database objects and data associated with tables.

Set Authentication to **Windows Authentication**. This is the default authentication type SQL Server gets installed with. This indicates that the machine's logged-in user name will be carried over to connect to SQL Server.

c:\Program Files (x86)\Microsoft SQL Server\MSSQL.1\MSSQL\Data\\**AdventureWorks_Data.mdf**
## Summary
# 2. Understanding Relational Databases
## What Is a Database?
DBMSs support **tables (aka relations or entities)** to store data in **rows (aka records or tuples)** and
**columns (aka fields or attributes)**, similar to how data appears in a spreadsheet application.

[W] tuple (to͞o′pəl, tŭp′əl)
- A generalization of ordered pairs, such as (-3, 4), and ordered triples, such as (0, -3, 5), in any dimension. An *n-tuple* is an ordered list of n numbers and can represent a point in n-dimensional space.

## Choosing Between a Spreadsheet and a Database
## Why Use a Database?
## Benefits of Using a Relational Database Management System
## Comparing Desktop and Server RDBMS Systems
### Desktop Databases
### Server Databases
## The Database Life Cycle
[T]

- ER: Entiry-Relationship
- DDL: Data Definition Language
- DML: Data Modification Language

## Mapping Cardinalities
[W] cardinality (ˌkɑːdɪˈnælɪtɪ)

-  (Mathematics) maths logic (of a class) the cardinal number associated with the given class. Two classes have the same cardinality if they can be put in one-to-one correspondence

`Mapping cardinalities`, or `cardinality ratios`, express the number of entities to which another entity can be associated via a relationship set. `Cardinality` refers to the uniqueness of data values contained in a particular column of a database table.

This relationship is actually implemented in a one-many-one format, so it requires a third table (often referred to as a **junction talbe**) to be introduced in between that serves as the path between the related tables.

Though relationships among tables are extremely important, **the term relational database** has nothing to
do with them. Relational databases are (to varying extents) based on the **relational model of data** invented by **Dr. Edgar F. Codd** at IBM in the 1970s. Codd based his model on the mathematical (set-theoretic) concept of a relation. **Relations are sets of tuples** that can be manipulated with a well-defined and well-behaved set of mathematical operations—in fact, two sets: **relational algebra** and **relational calculus**. You don’t have to know or understand the mathematics to work with relational databases, but if you hear it said that a database is relational because it “relates data,” you’ll know that whoever said it doesn’t understand relational databases.
## Understanding Keys
A **key** is one or more columns of a relation that is used to identify a row.
### Primary Keys
Besides helping in uniquely identifying a record, the primary key also helps in searching records because *an index automatically gets generated* as you assign a primary key to an attribute.

- candidate key
- composite key
- up to 16 attributes
- IDENTITY property
- `surrogate` key

[W] surrogate (sûr′ə-gĭt, -gāt′, sŭr′-)

- surrogate - someone who takes the place of another person
- =alternate, replacement
- <->backup man, fill-in, reliever, stand-in, backup, substitute, relief - someone who takes the place of another (as when things get dangerous or difficult); *"the star had a stand-in for dangerous scenes"; "we need extra employees for summer fill-ins"*

There are at least two definitions of a surrogate:

1. Hall, Owlett and Todd (1976) A surrogate represents an entity in the outside world. The surrogate is internally generated by the system but is nevertheless visible to the user or application. Surrogate
2. Wieringa and De Jonge (1991) A surrogate represents an object in the database itself. The surrogate is internally generated by the system and is invisible to the user or application. The Surrogate (1) definition relates to a data model rather than a storage model and is used throughout this article. See Date (1998).

Approaches to generating surrogates include:

- Universally Unique Identifiers (UUIDs)
- Globally Unique Identifiers (GUIDs)
- Object Identifiers (OIDs)
- Sybase or SQL Server identity column IDENTITY OR IDENTITY(n,n)
- Oracle SEQUENCE, or GENERATED AS IDENTITY (starting from version 12.1)[2]
- PostgreSQL or IBM Informix serial
- MySQL AUTO_INCREMENT
- AutoNumber data type in Microsoft Access
- AS IDENTITY GENERATED BY DEFAULT in IBM DB2
- Identity column (implemented in DDL) in Teradata
- Table Sequence when the sequence is calculatd by a procedure and a sequence table with fields: id, - sequenceName, sequenceValue and incrementValue

### Foreign Keys
## Understanding Data Integrity
### Entity Integrity
The requirement that primary key values exist and that they are unique is known as **entity integrity (EI)**.
### Referential Integrity
## Normalization Concepts
Normalized database desgins usually reduce **update processing** costs but can make **query processing** more complicated. These *trade-offs* must be carelly evaluated in terms of the required performance profile of a database. Often, a database design needs to be *denormalized* to adequately meet *operational needs*.

[W] The result of each process is referred to as a normal form. Five normal forms have been identified in theory, but most of the time third normal form (3NF) is `as far as` you need to go in practice.
## Drawbacks of Normalization
Database design is an art more than a technology, and applying normalization wisely is always important.

With either normalization or denormalization, **the goal is to control redundancy** so that the database design *adequately* (and *ideally*, *optimally*) supports the actual use of the database.
## Summary
# 3. Creating Database and Tables
## Launching SQL Server Management Studio
## Types of SQL Server Databases
## The Architecture of a SQL Server Database
## Creating a Database in a Simple Way
## Exploring Database Properties
## Creating Database with Your Own Settings

    ```
    CREATE DATABASE joydb
    ON PRIMARY
    (
        NAME = joyData,
        FILENAME = 'c:\Program Files (x86)\Microsoft SQL Server\MSSQL.1\MSSQL\Data\joyData.mdf',
        SIZE = 5MB,
        MAXSIZE = 15MB,
        FILEGROWTH = 20%
    )
    LOG ON
    (
        NAME = joyLog,
        FILENAME = 'c:\Program Files (x86)\Microsoft SQL Server\MSSQL.1\MSSQL\Data\joyLog.ldf',
        SIZE = 1MB,
        MAXSIZE = 5MB,
        FILEGROWTH = 1MB
    )
    ```

Error

- Access Error on the file: Services->Log On Tab->Check Local System Account
- File Size: 4MB -> 5MB

 SqlConnection conn = new SqlConnection(@"server = .\SQLExpress;integrated security = true; database = joydb");

```
            //- Create command
            private void CommandText_Load(object sender, EventArgs e)
            {
                //- Create connection
                SqlConnection conn = new SqlConnection(@"server = .\SQLExpress;integrated security = true; database = joydb");

                //- Create command
                SqlCommand cmd = new SqlCommand();

                try
                {
                    //- Open connection
                    conn.Open();

                    txtCommandText.AppendText("Connection opened \n");
                    txtCommandText.AppendText("Command created.\n");

                    //- Setting CommandText
                    cmd.CommandText = @"select Name, ProductNumber from Production.Product";
                    txtCommandText.AppendText("Ready to execute SQL Statement: \n\t\t\t" + cmd.CommandText);
                }
                catch (SqlException ex)
                {
                    MessageBox.Show(ex.Message + ex.StackTrace, "Exception Details");
                }
                finally
                {
                    conn.Close();
                    txtCommandText.AppendText("\nConnection Closed.");
                }
            }
```

### Understanding Table Fundamentals
### SQL Server Data Types for Table Columns
### Creating a Table in SQL Server

```
CREATE TABLE MySqlTable
(
    Name varchar(10) Not Null, --Name value is a must and can''t be Null
    Age int,
    SSN varchar(11),
    Date datetime,
    Gender char(6)
)
```

### Adding an IDENTITY Column in a Table
[W] In this case, the table you created is missing a column that can help uniquely identify each person, because a name could be `common` with two people; for example, both might be the same age and gender and without an SSN.

#### ALTER TABLE
```
ALTER TABLE MySqlTable
ADD Id int IDENTITY(1,1)
```

#### DROP and Re-create the Table
```
DROP TABLE MySqlTable

CREATE TABLE MySqlTable
(
    Id int IDENTITY (1,1), --Identity makes the column Not Null internally
    Name varchar(10) Not Null, --Name value is a must and can''t be Null
    Age int,
    SSN varchar(11),
    Date datetime,
    Gender char(6)
)
```


## Summary
# 4. Manipulating Database Data
## Inserting Data
### Try It: Inserting a New Row
### How It Works
SQL Server can detect an identity column when executing the INSERT statement. However, it is best practice to specify the column list and then pass the respective values to these fields, as shown in the following query:

```
--These result in the same

insert into MySqlTable (Name, Age, SSN, Date, Gender)
values('비댜 브랕', 36, '111-20-3456', GetDate(), 'Male')

insert into MySqlTable
values('비댜 브랕', 36, '111-20-3456', GetDate(), 'Male')
```

## Inserting Multiple Rows Through a Single INSERT Statement
Typically a single INSERT statement added one row to the table, but <u>*since SQL Server 2008*</u>, an INSERT statement is capable of adding multiple rows via a single INSERT statement. You just need to *separate each row of data with a comma*, as shown in the following statement, and then click Execute or press F5.
## Updating Data
[W] So, always code an appropriate WHERE clause; if you miss a WHERE clause, as shown in the following UPDATE statement, then you will change all the records of the table, and I am sure no `business case` requires that!
### Try It: Updating a Row
### How It Works
## Deleting Data
## Summary
# 5. Querying Databases
SQL Server uses *T-SQL* as its language, and it has a wide variety of functions and constructs for querying.
## Retrieving Data
In T-SQL, queries are called SELECT statements, but the ISO/ANSI standard clearly distinguishes “queries” from “statements.” The distinction is conceptually important. <u>A **query** is an operation on a table that produces a table as a result</u>; **statements** may (or may not) operate on tables and don’t produce tables as results. Furthermore, **subqueries** can be used in both queries and statements.
### Try It: Running a Simple Query
[W] You ask the database to return the data for all the columns, and you `get exactly that`.
### How It Works
### Using the WHERE Clause
[W] collate (kə-lāt′, kŏl′āt′, kō′lāt′)

[From Latin collātus, past participle of cōnferre, to bring together : com-, com- + lātus, brought; see telə- in Indo-European roots.]

>collate - to assemble in proper sequence; "collate the papers"

- <>order - bring order to or into; "Order these files"

- =collect, gather, organize, assemble, compose, adduce, systematize *"Roberts collated the data on which the study was based."*

<u>*SQL Server keywords are not case-sensitive.*</u> SQL Server case sensitivity depends upon the *collation setting of the database*. However, the default collation of the SQL Server installation, `SQL_Latin1_General_CP1_CI_AS`, is not case-sensitive. So, most of the time, developers will not need to worry about case sensitivity. *But the AdventureWorks database is set as case-sensitive.* Hence, if you try running the query shown in Figure 5-4 with redmond, you will not show any result rows because of case sensitivity, which will not find a city with the provided name.
### Using Comparison Operators

As mentioned earlier, <u>**every database vendor has its own implementation of SQL**</u>. This discussion is specific to T-SQL; for example, standard SQL doesn’t have the **!=** operator and calls **<>** the not equals operator. In fact, standard SQL calls the expressions in a WHERE clause **predicates**; we’ll use that term because predicates are either true or false, but other expressions don’t have to be. If you work with another version of SQL, please refer to its documentation for specifics.

[W] predicate (prĕd′ĭ-kāt′) n. (-kĭt) adj. (-kĭt) joy: true or false about the subject

1. Grammar One of the two main constituents of a sentence or clause, modifying the subject and including the verb, objects, or phrases governed by the verb, as opened the door in Jane opened the door or is very sleepy in The child is very sleepy.
2. Logic That part of a proposition that is affirmed or denied about the subject. For example, in the proposition We are mortal, mortal is the predicate.

>predicate - affirm or declare as an attribute or quality of; "The speech predicated the fitness of the candidate to be President"

- =proclaim
- <>assert, asseverate, maintain - state categorically
## Sorting Data
### Try It: Writing an Enhanced Query
### How It Works
## GROUP BY Clause
The GROUP BY clause is used to organize output rows into groups. The SELECT list can include aggregate functions and <u>**produce summary values**</u> for each group.
### Try It: Using the GROUP BY Clause
### How It Works
## Pattern Matching
### Try It: Using the Percent (%) Character
### How It Works
### Try It: Using the Underscore (_) Character
### How It Works
### Try It: Using the Square Bracket ([]) Characters
### How It Works
### Try It: Using the Square Bracket and Caret ([^ ]) Characters
### How It Works
## Aggregate Functions
**Aggregate functions** are applied on sets of rows and return a single value.

Logical Processing Order or Binding Order of queries

    1. FROM
    2. ON
    3. OUTER
    4. WHERE
    5. GROUP BY
    6. CUBE | ROLLUP
    7. HAVING
    8. SELECT
    9. DISTINCT
    10 ORDER BY
    11. TOP
### Try It: Using the MIN, MAX, SUM, and AVG Functions
### How It Works
### Try It: Using the COUNT Function
### How It Works
## DATETIME Functions
### Try It: Using T-SQL Date and Time Functions
### How It Works
## List Operator
### Try It: Using the IN Operator
### How It Works
### Try It: Using the NOT IN Operator
### How It Works
## Range Operator
### Try It: Using the BETWEEN Operator
### How It Works
### Try It: Using the NOT BETWEEN Operator
### How It Works
## Finding NULL Values
### Try It: Using IS NULL Operator
### How It Works
### Try It: Using the IS NOT NULL Operator
### How It Works
## Joins
A **join** is a relational operation that produces a table by retrieving data from two (not necessarily *distinct*) tables and matching their rows according to a *join specification*.

Different types of joins exist, which you'll look at individually, <u>but keep in mind that every join is a **binary operation**</u>; that is, one table is joined to another, which may be *the same table* since tables can be joined to themselves.
### Inner Joins
It returns only those rows that satisfy the join specificatin.

Joins using the equality operator are called **natural joins**.
### Table Aliasing
### Outer Joins
Outer joins return all rows from (at least) one of the joined tables even if rows in one table don't match rows in the other. Three types of outer joins exist: **left outer join**, **right outer join**, and **full outer join**.

In a **left outer join**, all rows from the left table will be retrieved whther they have matching in the right table. `Conversely`, in a **right outer join**, all rows from the right table will be retrieved whether they have matching rows in the left table. In a **full outer join**, all rows from both tables are returned.
### Other Joins
## Summary
# 6. Using Stored Procedures
## Creating Stored Procedures
### Try It: Working with Stored Procedures in SQL Server
### How It Works
### Try It: Creating a Stored Procedure with an Input Parameter
### How It Works
### Try It: Creating a Stored Procedure with an Output Parameter
### How It Works
## Modifying Stored Procedures
### Try It: Modifying Your Trivial Stored Procedure
### How It Works
## Displaying the Definition of Stored Procedures
### Try It: Viewing the Definition of Our Stored Procedure
### How It Works
## Renaming Stored Procedures
### Try It: Renaming a Stored Procedure
### How It Works
## Deleting Stored Procedures
### Try It: Deleting a Stored Procedure
## Summary
# 7. Using XML
## Defining XML
[T] SGML: Standard Generalized Markup Language

[T] metalanguage
>A metalanguage isn't used for programming but rather for defining other languages, and the languages XML defines are known as *markup languages*.

[T] XSD: XML Schema Definition
>XML Schema Definition (XSD) is the language for defining XML vocabularies.
## Why XML
## Benefits of Storing Data As XML
## Understanding XML Documents
## Understanding the XML Declaration
[W] The most fundamental rule is that XML documents must be *well-formed*. `At its simplicity`, this means that overlapping elements aren't allowed, so you must close all child elements before the end tag of their parent element.

root element = document element
## Converting Relational Data to XML
### Using FOR XML RAW
### Try It: Using FOR XML RAW (Attribute-centric)
### How It Works
### Try It: Using FOR XML RAW (Element-centric)
### How It Works
### Try It: Renaming the row Element
### How It Works
### Observations About XML RAW Formatting
### Using FOR XML AUTO
### Try It: Using FOR XML AUTO
### How It Works
### Observations About XML AUTO Formatting
## Using the XML Datatype
### Try It: Creating a Table to Store XML
### How It Works
### Try It: Storing and Retrieving XML Documents
### How It Works
## Summary
# 8. Understanding Transactions
## What Is a Transaction?
### When to Use Transactions
## Understanding ACID Properties
### Transaction Design
## Transaction State
### Specifying Transaction Boundaries
### T-SQL Statements Allowed in a Transaction
### Local Transactions in SQL Server 2012
### Distributed Transactions in SQL Server 2012
### Guidelines to Code Efficient Transactions
### How to Code Transactions
### Coding Transactions in T-SQL
## Summary
# 9. Building Windows Forms Applications
## Understanding Windows Forms
### User Interface Design Principles
### Best Practices for User Interface Design
### Position of Controls
### Fonts
### Images and Icons
### Working with Windows Forms
### Understanding the Design and Code Views
### Sorting Properties in the Properties Window
### Categorized View
## Setting the Properties of Solutions, Projects, and Windows Forms
### Working with Controls
## Setting Dock and Anchor Properties
### Dock Property
### Anchor Property
### Adding a New Form to the Project
### Implementing an MDI Form
## Summary
# 10. Introduction to ADO.NET
## Understanding ADO.NET
### The Motivation Behind ADO.NET
### Moving from ADO to ADO.NET
### ADO.NET Isn’t a New Version of ADO
### ADO.NET and the .NET Base Class Library
### Understanding ADO.NET Architecture
### Understanding .NET Data Providers
### Understanding the SQL Server Data Provider
### Understanding the OLE DB Data Provider
### Understanding the ODBC Data Provider
## Data Providers Are APIs
## Summary
# 11. Handling Exceptions
## The System.Exception Class
## What Causes an Exception to Occur
### Try It: Creating a File-Handling Application
### Try It: Causing an Exception to Occur and Observing the Behavior
## Exploring the Type, Message, and StackTrace Properties of an Exception
## Handling Exceptions
### Try It: Adding Exception-Handling Statements
### How It Works
## Summary
# 12. Making Connections
## Introducing the Data Provider Connection Classes
## Connecting to SQL Server 2012 with SqlConnection
### Try It: Using SqlConnection
### How It Works
### Debugging Connections to SQL Server
### Security and Passwords in SqlConnection
### How to Use SQL Server Security
### Connection String Parameters for SqlConnection
### Connection Pooling
## Improving Your Use of Connection Objects
### Using the Connection String in the Connection Constructor
### Displaying Connection Information
### Try It: Displaying Connection Information
### How It Works
## Connecting to SQL Server with OleDbConnection
### Try It: Connecting to SQL Server with the OLE DB Data Provider
### How It Works
## Summary
# 13. Executing ADO.NET Commands to Retrieve Data
## Creating a Command
### Assigning Text to a Command
## Executing Commands
### Executing Commands with a Scalar Query
## Try It: Using the ExecuteScalar Method
### Executing Commands with Multiple Results
### Executing Nonquery Statements
## Working with Stored Procedures
### Creating a Stored Procedure to Perform a Delete Operation
## Summary
# 14. Using Data Readers
## Understanding Data Readers in General
### Using Ordinal Indexers
### Using Column Name Indexers
### Using Typed Accessor Methods
### Getting Data About Data
### Getting Data About Tables
### Using Multiple Result Sets with a Data Reader
## Summary
# 15. Using Data Sets and Data Adapters
## Understanding the Object Model
### Data Sets vs. Data Readers
### A Brief Introduction to Data Sets
### A Brief Introduction to Data Adapters
### A Brief Introduction to Data Tables, Data Columns, and Data Rows
## Working with Data Sets and Data Adapters
### Filtering and Sorting in a Data Set
### Comparing FilterSort to PopDataSet
### Using Data Views
### Modifying Data in a Dataset
### Propagating Changes to a Data Source
### InsertCommand Property
### Command Builders
### Concurrency
## Using Data Sets and XML
### Understanding Typed and Untyped Data Sets
## Summary
# 16. Using Data Controls with ASP.NET Applications
## Understanding Web Functionality
### The Web Server
## Understanding ASP.NET and Web Pages
## Understanding the Visual Studio 2012 Web Site Types
## Understanding the Layout of an ASP.NET Web Site
## Understanding the Web UI of ASP.NET Web Apps
## Using the Repeater Control
## Summary
# 17. Working with Text and Binary Data
## Understanding SQL Server Text and Binary Data Types
## Storing Images in a Database
### Retrieving Images from a Database
### Working with Text Data
### Retrieving Data from Text Columns
## Summary
# 18. Using LINQ
## Introduction to LINQ
## Architecture of LINQ
## LINQ Project Structure
### Using LINQ to Objects
### Using LINQ to SQL
### Using LINQ to XML
## Summary
# 19. Using the ADO.NET Entity Framework
## Understanding ADO.NET Entity Framework 5.0
## Understanding the Entity Data Model
### Working with the Entity Data Model
## Summary
# 20. Using the CLR in SQL Server
## Introducing SQL CLR
## Choosing Between T-SQL and SQL CLR
## Enabling SQL CLR Integration
## Creating a SQL CLR Stored Procedure
### Try It: Creating a SQL CLR Stored Procedure Using C#
### How It Works
## Deploying a SQL CLR Stored Procedure into SQL Server
### Try It: Deploying SQL CLR C# Stored Procedure in SQL Server
### How It Works
## Executing the SQL CLR Stored Procedure
### Try It: Executing the SQL CLR Stored Procedure
### How It Works
## Summary